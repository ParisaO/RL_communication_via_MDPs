# -*- coding: utf-8 -*-
"""RL_project_installed.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VCb2a_u_pF3QyCUIOKoNSstGQnkh88IJ

# Initializations
"""

import shutil
import os
# Specify the path of the folder you want to clear
folder_path = '/content'

# Use shutil.rmtree() to remove the entire folder and its content
shutil.rmtree(folder_path)

# Create an empty folder at the same path
os.makedirs(folder_path)

! git clone https://github.com/ParisaO/RL_communication_via_MDPs.git

import os
print(os.getcwd())
os.chdir ('/content/RL_communication_via_MDPs')
!mkdir results
!mkdir screenes
!mkdir CSV

!pip install cffi
!pip install gym-minigrid==1.0.2
!pip install gymnasium
!pip install -U gym
!pip install "gym[atari, accept-rom-license]"
!pip install -U gymnasium
!pip install "gymnasium[atari, accept-rom-license]"
!pip install buffer
import numpy as np
import matplotlib.pyplot as plt

!pip install -r requirements.txt

"""# Grildworld

**Train gridworld 4x4 MaxEnt**
"""

!python train_gridworld.py --exp-name "final_4x4" --net "mlp_deep" --net-device "cuda:0" --log-betas-range-lunch 0.1 5\
 --log-betas-eval 0.1 0.5 2.5 3.5 --env-arg-grid-dim 4 4 --env-arg-max-steps 8 --lr 0.0005  \
 --eval-every-x-episodes 1000

import matplotlib.pyplot as plt
import numpy as np
import math
loss_train = np.loadtxt('/content/RL_communication_via_MDPs/CSV/loss_train.txt')
# eps = np.loadtxt('/content/RL_communication_via_MDPs/CSV/episodes.txt')
# steps = np.loadtxt('/content/RL_communication_via_MDPs/CSV/num_steps.txt')
test_reward = np.loadtxt('/content/RL_communication_via_MDPs/CSV/test_reward.txt')

#test reward
plt.figure(figsize=(16, 6))
X_test = range(test_reward.shape[0])
plt.plot(X_test, test_reward[:,0], color='b', label='log beta = 0.1')
plt.plot(test_reward[:,1], color='g', label='log beta = 1')
plt.plot(test_reward[:,2], color='r', label='log beta = 2')
plt.plot(test_reward[:,3], color='y', label='log beta = 5')

plt.xlabel("Evaluation")
plt.ylabel("test reward")
plt.title("test accumulated reward")
plt.legend()
plt.grid()
plt.show()

plt.figure(figsize=(16,6))
plt.plot(loss_train, color='r',label='train loss for 1M iterations')
plt.xlabel("model saving")
plt.ylabel("train_loss")
plt.legend()
plt.grid()
plt.show()

!apt-get install zip

"""Downloading the results"""

from google.colab import files
!zip -r result_300k.zip '/content/RL_communication_via_MDPs/CSV'
files.download('result_1M.zip')
